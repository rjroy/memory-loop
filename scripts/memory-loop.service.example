# Memory Loop systemd user service
#
# Installation:
#   1. Copy to ~/.config/systemd/user/memory-loop.service
#   2. Edit paths and environment variables below
#   3. Run: systemctl --user daemon-reload
#   4. Run: systemctl --user enable --now memory-loop
#
# To start at boot without login:
#   loginctl enable-linger $USER
#
# Logs:
#   journalctl --user -u memory-loop -f
#
# TLS:
#   Next.js does not handle TLS directly. Use a reverse proxy (nginx, caddy)
#   for HTTPS termination. See docs/deployment/https-setup.md.

[Unit]
Description=Memory Loop - Obsidian vault interface
After=network.target

[Service]
Type=simple
WorkingDirectory=/home/YOUR_USER/Projects/memory-loop

# Build Next.js before starting (remove if you build separately)
ExecStartPre=/usr/bin/env bash -c 'cd nextjs && bun run build'

# Start the Next.js server
ExecStart=/usr/bin/env bash -c 'cd nextjs && exec bun run start'

Restart=on-failure
RestartSec=5

# Environment - edit these for your setup
Environment=NODE_ENV=production
Environment=VAULTS_DIR=/path/to/your/vaults
Environment=PORT=3000
Environment=HOSTNAME=0.0.0.0

# Uncomment if bun is not in default PATH
#Environment=PATH=/home/YOUR_USER/.bun/bin:/usr/local/bin:/usr/bin:/bin

# Or use an environment file instead of inline variables:
#EnvironmentFile=/home/YOUR_USER/.config/memory-loop.env

[Install]
WantedBy=default.target
